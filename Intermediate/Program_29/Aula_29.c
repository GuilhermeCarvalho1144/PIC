//CURSO DE PIC
//PROGRAMA 29...ESSE CODIGO FOI DESENVOLVIDO PARA O TESTE DO TIMER 2 COM O PIC16F628A
//MAIS INFORMÇÕES NO LINK : https://www.youtube.com/watch?v=6jFhy32UCEw&index=29&list=PLZ8dBTV2_5HQ-LrS9r1dP30h8n9sh04gh&t=227s
//GUILHERME CARVALHO PEREIRA
//INICIO

/*ESSA FUNÇÃO JÁ É IMPLEMENTADA NO MIKROC...ELA AJUDA O PROGRAMADOR A TRATAR DE INTERRUPÇÕES (VEJA O HELP)....
ESSA FUNÇÃO É DO TIPO VOID, PORTANTO NAO POSSUI RETONO...TAMBÉM NÃO POSSUI NENHUM TIPO DE PARAMETRO...
*/
void interrupt(){//VARREDURA ACONTECE A CADA 50ms APROXIMADAMENTE
     if(TMR2IF_bit){//VERIFICA SE HOUVE ESTOURO DO TIMER 2
                    TMR2IF_bit = 0x00;//LIMPA A FLAG DE INTERRUPÇÃO DO TIMER 2...***IMPORTANTE***
                    TMR2 = 0x7D;//REDEFINE O VALOR DE TIMER 2
                    PORTB = ~PORTB;//INVERTE O VALOR DO PORTB
     }
}

//FUNÇÃO MAIN
void main() {
     //CONFIGURANDO OS REGISTRADORES
     CMCON = 0x07;                  //DESABILITA OS COMPARADORES
     //CONFIGURANDO OS REGISTRADORES DA INTERRUPÇÃO
     GIE_bit = 0x01;                 //HABILITA AS INTERRUPÇÕES GLOBAIS
     PEIE_bit = 0x01;                //HABILITA AS INTERRUPÇÕES POR PERIFERICOS
     TMR2IE_bit = 0x01;              //HABILITA AS INTERRUPÇÕES DO TIMER 2
     T2CON = 0b01111111;             //CONFIGURA O TIMER 2...BIT MAIS SIGNIFICATIVO NÃO É IMPLEMENTADO
                                     //...REGISTRADOR POSSUI SO 7 BITS...DOS 7 BITS OS 4 MAIS SIGNIFATIVOS CONFIGURAM O
                                     //PROSCALER...O 3 BIT MENOS SIGNIFICATIVO LIGA O TIMER 2 (SEMPRE EM 1).., OS DOIS
                                     //ULTIMOS BITS CONFIGURAM O PRESCALER
     TMR2 = 0xC3;                    //DEFINE O VALOR DE CONTAGEM PARA QUE O TIMER 2 ESTOURE A CADA 50ms...APROXIMADAMENTE
                                     //EQUAÇÃO...CICLO DE MAQUINA * TMR2 * PRESCALER * POSSCALER = ESTOURO
     //CONFIGURANDO O PORTB
     TRISB = 0x00;                   //CONFIGURA TODO O PORTB COMO SAIDA DIGITAL
     PORTB = 0x00;                   //INICIA O PORTB COM NIVEL BAIXO
     //ESSE CODIGO NAO POSSUI LOOP PRINCIPAL POIS A LOGICA ESTA IMPLEMENTADA NA INTERRUPÇÃO
}
//FIM